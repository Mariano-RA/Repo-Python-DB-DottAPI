Cambiar el formato del excel a la version mas nueva

Borrar las filas que no sirven y dejar la de la primera categoria de auriculares
Verificar los espacios en blanco
agregar la columna categoria y en la primer celda pegar la siguiente formula

=SI(Y(ESBLANCO(B1); ESBLANCO(B2));CONCAT(A1;" - ";A2);SI(ESBLANCO(E3);"";SI(LARGO(B2)<2; CONCAT(IZQUIERDA(G1; ENCONTRAR(" - "; G1) - 1);" - ";A2);G2)))

=IF(AND(ISBLANK(B1), ISBLANK(B2)),CONCAT(A1," - ",A2),IF(ISBLANK(E3),"",IF(LEN(B2)<2, CONCAT(LEFT(G1, FIND(" - ", G1) - 1)," - ",A2),G2)))

app = xw.App(visible=False)  # Abre Excel en segundo plano
    libro = app.books.open(listadosTemporales + 'temp_invid.xlsx')
    hoja = libro.sheets["Sheet1"]

    # Encuentra el último número de fila en la columna 'I'
    ultima_fila = hoja.range("I" + str(hoja.cells.last_cell.row)).end("up").row

    # Empieza en la fila 2 para omitir encabezados
    for fila_numero in range(2, ultima_fila + 1):
        celda_formula = hoja.range("I" + str(fila_numero))
        resultado = celda_formula.value
        celda_formula.value = resultado

    # Cierra el archivo Excel
    libro.save()
    libro.close()
    app.quit()